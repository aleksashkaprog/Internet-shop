stages:
  - linting
  - test

flake8:
  stage: linting
  image: registry.gitlab.com/pipeline-components/flake8:latest
  script:
    - flake8 --verbose .

unit-test:
  image: docker:20.10.16
  services:
    - docker:20.10.16-dind
  before_script:
    - docker version
    - docker-compose version
  build:
    stage: build
    script:
      - docker build -t my-docker-image .
      - docker run my-docker-image python manage.py test
